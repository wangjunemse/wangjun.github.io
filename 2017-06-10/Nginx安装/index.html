<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="This is personal blog of wangjun, aimed at sharing knowledge on software engineering, including distributed ledger technlogy (or blockchain), high concurrency systems, distributed systems, etc. More specifically, you acn find blogs on redis, kafka, mongodb, mysql, docker, k8s, nginx, golang, java, python, C, etc.">
  <meta name="keyword" content="distributed ledger technology, blockchain, ethereum, hyperledger, go, golang, redis, kafka, nginx, docker, k8s">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      Nginx 安装 | jun&#39;s studio
    
  </title>
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/gitment.css">
  <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>
  <script src="/js/qrious.js"></script>
<script src="/js/gitment.js"></script>
</head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>jun's studio</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/project/" class="item-link">Projects</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/project/" class="menu-link">Projects</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>Nginx 安装</h2>
  <p class="post-date">2017-06-10</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><h1 id="nginx安装和配置"><a href="#nginx安装和配置" class="headerlink" title="nginx安装和配置"></a>nginx安装和配置</h1><h2 id="nginx安装"><a href="#nginx安装" class="headerlink" title="nginx安装"></a>nginx安装</h2><p>nginx依赖以下模块:</p>
<ul>
<li>gzip模块需要<strong>zlib</strong>库</li>
<li>rewrite模块需要<strong>pcre</strong>库</li>
<li>ssl 功能需要<strong>openssl</strong>库</li>
</ul>
<ol>
<li><p><strong>安装pcre</strong></p>
<ol>
<li>获取pcre编译安装包，在<a href="http://www.pcre.org/" target="_blank" rel="noopener">http://www.pcre.org/</a>上可以获取当前最新的版本。</li>
<li>解压缩pcre-xx.tar.gz包。</li>
<li>进入解压缩目录，执行<code>./configure &amp;&amp; make &amp;&amp; make install</code></li>
</ol>
</li>
<li><p><strong>安装openssl</strong></p>
<ol>
<li>获取openssl编译安装包，在<a href="http://www.openssl.org/source/" target="_blank" rel="noopener">http://www.openssl.org/source/</a>上可以获取当前最新的版本。</li>
<li>解压缩openssl-xx.tar.gz包。</li>
<li>进入解压缩目录，执行<code>./configure &amp;&amp; make &amp;&amp; make install</code></li>
</ol>
</li>
<li><p><strong>安装zlib</strong></p>
<ol>
<li>获取zlib编译安装包，在<a href="http://www.zlib.net/" target="_blank" rel="noopener">http://www.zlib.net/</a>上可以获取当前最新的版本。</li>
<li>解压缩openssl-xx.tar.gz包。</li>
<li>进入解压缩目录，执行<code>./configure &amp;&amp; make &amp;&amp; make install</code></li>
</ol>
</li>
<li><p><strong>安装nginx</strong></p>
<ol>
<li>获取nginx，在<a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">http://nginx.org/en/download.html</a>上可以获取当前最新的版本。</li>
<li>解压缩nginx-xx.tar.gz包。</li>
<li>进入解压缩目录，执行<code>./configure &amp;&amp; make &amp;&amp; make install</code></li>
</ol>
</li>
</ol>
<p><strong>note:</strong> 若安装时找不到上述依赖模块，使用–with-openssl=<openssl_dir>、–with-pcre=<pcre_dir>、–with-zlib=<zlib_dir>指定依赖的模块目录。如已安装过，此处的路径为安装目录；若未安装，则此路径为编译安装包路径，nginx将执行模块的默认编译安装。</zlib_dir></pcre_dir></openssl_dir></p>
<p><strong>Error:</strong><br><em>src/core/ngx_regex.h:15:18: fatal error: pcre.h: No such file or directory</em><br><strong>Solution</strong><br><code>apt-get install libpcre3-dev</code>, 编译时需要去掉–with-pcre=<pcre_dir></pcre_dir></p>
<h2 id="nginx-使用"><a href="#nginx-使用" class="headerlink" title="nginx 使用"></a>nginx 使用</h2><h3 id="启动nginx"><a href="#启动nginx" class="headerlink" title="启动nginx"></a>启动nginx</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/nginx/sbin</span><br><span class="line">./nginx</span><br></pre></td></tr></table></figure>
<p><strong>note</strong>：添加niginx路径至/etc/profile 可以在任意位置执行nginx命令</p>
<p><strong>若出现Error:</strong> <em>libpcre.so.1: cannot open shared object file</em><br><strong>解决方案:</strong><br>64位系统： <code>ln -s /usr/local/lib/libpcre.so.1 /lib64</code><br>32位系统： <code>ln -s /usr/local/lib/libpcre.so.1 /lib</code></p>
<p>启动nginx之后，浏览器中输入<a href="http://localhost可以验证是否安装启动成功。" target="_blank" rel="noopener">http://localhost可以验证是否安装启动成功。</a></p>
<p><strong>note:</strong> 若提示没有安装c++编译器，下载新版gcc安装，或<code>apt-get install g\+\+</code>即可</p>
<ol>
<li>获取gccl编译安装包，在<a href="http://ftp.gnu.org/gnu/gcc/gcc-5.5.0/" target="_blank" rel="noopener">http://ftp.gnu.org/gnu/gcc/gcc-5.5.0/</a>上可以获取当前最新的版本。</li>
<li>解压缩gcc-xx.tar.gz包。</li>
<li>进入解压缩目录，执行<code>./configure &amp;&amp; make &amp;&amp; make install</code></li>
</ol>
<h3 id="nginx操作"><a href="#nginx操作" class="headerlink" title="nginx操作"></a>nginx操作</h3><p>nginx的启动后，它可以通过与-s参数执行来控制。使用以下语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s signal</span><br></pre></td></tr></table></figure></p>
<ul>
<li><strong><em>stop</em></strong> — 快速关闭</li>
<li><strong><em>quit</em></strong> — 正常关闭</li>
<li><strong><em>reload</em></strong> —重新加载配置文件</li>
<li><strong><em>reopen</em></strong> — 重新打开日志文件</li>
</ul>
<p>若关闭nginx进程时，先等工作进程完成后停止，这个命令应该在启动nginx的相同用户下执行。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s quit</span><br></pre></td></tr></table></figure></p>
<p>配置文件中的更改不会被立即生效，直到命令重新加载配置或重新启动。重新加载配置，执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx -t   #测试修改后的配置文件OK，然后再reload</span><br><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure></p>
<p>一旦主进程接收重新加载配置的信号，它检查新配置文件语法的正确性并尝试应用配置，如果是一次成功，主进程开始新的工作流程，将消息发到老的工作进程，要求它们关闭，否则，主进程回滚，继续在老的配置下运行。老的工作进程，接收命令进行关闭，停止接收新连接，并继续运行当前的请求，直到所有这些请求结束，在这之后，老的工作进程停止。</p>
<p>也可以发送到nginx进程的Unix命令工具，如<strong><em>kill</em></strong>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -s QUIT 1628</span><br></pre></td></tr></table></figure></p>
<p><strong>Error:</strong><br><em>openssl: error while loading shared libraries: libssl.so.1.1: cannot open shared object file: No such file or directory</em><br><strong>Solution:</strong><br><code>ln -s /usr/local/lib/libssl.so.1.1 /usr/lib/libssl.so.1.1</code><br><code>ln -s /usr/local/lib/libcrypto.so.1.1 /usr/lib/libcrypto.so.1.1</code></p>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#Linux" >
    <span class="tag-code">Linux</span>
  </a>

  <a href="/tags#web" >
    <span class="tag-code">web</span>
  </a>

  <a href="/tags#Nginx" >
    <span class="tag-code">Nginx</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- 打赏 START -->
    
    <!-- 打赏 END -->
    <!-- 二维码 START -->
    <div class="qrcode">
      <canvas id="share-qrcode"></canvas>
      <p class="notice">扫描二维码，分享此文章</p>
    </div>
    <!-- 二维码 END -->
    
      <!-- Gitment START -->
      <div id="comments"></div>
      <!-- Gitment END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#nginx安装和配置"><span class="toc-nav-text">nginx安装和配置</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#nginx安装"><span class="toc-nav-text">nginx安装</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#nginx-使用"><span class="toc-nav-text">nginx 使用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#启动nginx"><span class="toc-nav-text">启动nginx</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#nginx操作"><span class="toc-nav-text">nginx操作</span></a></li></ol></li></ol></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'http://wangjunstudio.com/2017-06-10/Nginx安装/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

     // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()
        
        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })

    // qrcode
    var qr = new QRious({
      element: document.getElementById('share-qrcode'),
      value: document.location.href
    });

    // gitment
    var gitmentConfig = "wangjunemse";
    if (gitmentConfig !== 'undefined') {
      var gitment = new Gitment({
        id: "Nginx 安装",
        owner: "wangjunemse",
        repo: "wangjunemse.github.io",
        oauth: {
          client_id: "a41bbc3d8fbc411f8d16",
          client_secret: "b00abbaf36fd88c4272470ec2ac004e29ffcfae0"
        },
        theme: {
          render(state, instance) {
            const container = document.createElement('div')
            container.lang = "en-US"
            container.className = 'gitment-container gitment-root-container'
            container.appendChild(instance.renderHeader(state, instance))
            container.appendChild(instance.renderEditor(state, instance))
            container.appendChild(instance.renderComments(state, instance))
            container.appendChild(instance.renderFooter(state, instance))
            return container;
          }
        }
      })
      gitment.render(document.getElementById('comments'))
    }
  })();
</script>

    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2015 - 2017   <a href="http://wangjunstudio.com">Wang Jun</a>, all rights reserved
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->

<script src="/js/script.js"></script>

  </body>
</html>